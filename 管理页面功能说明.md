# HTML-Go 管理页面功能说明

## 概述
管理页面是HTML-Go项目的后台管理功能，允许管理员查看、搜索和管理所有上传的页面内容。

## 功能特性

### 1. 统计信息展示
- **总页面数**: 显示系统中所有页面的总数量
- **受保护页面**: 显示设置了密码保护的页面数量
- **今日新增**: 显示今天新创建的页面数量
- **最近7天**: 显示最近7天内创建的页面数量

### 2. 页面管理
- **页面列表**: 以表格形式展示所有页面信息
  - 页面标题（从HTML的title标签提取）
  - 页面ID（可点击查看）
  - 代码类型（HTML、Markdown、SVG、Mermaid）
  - 保护状态（受保护/公开）
  - 创建时间
  - 操作按钮（查看、删除）

### 3. 搜索功能
- 支持按页面标题搜索
- 支持按页面ID搜索
- 实时搜索结果更新

### 4. 批量操作
- 全选/取消全选功能
- 批量删除选中的页面
- 删除确认对话框防止误操作

### 5. 分页功能
- 每页显示10条记录
- 支持页码跳转
- 显示当前页面信息和总记录数

## 访问方式

### 1. 通过首页链接
- 在首页头部点击"管理页面"按钮
- 需要先登录系统

### 2. 直接访问
- 访问 `/admin` 路径
- 系统会自动检查登录状态

## 权限要求
- 需要管理员登录
- 使用与系统相同的认证机制
- 未登录用户会被重定向到登录页面

## API接口

### 1. 获取统计信息
```
GET /api/admin/stats
```
返回系统统计数据

### 2. 获取页面列表
```
GET /api/admin/pages?page=1&limit=10&search=关键词
```
支持分页和搜索的页面列表

### 3. 删除单个页面
```
DELETE /api/admin/pages/:id
```
删除指定ID的页面

### 4. 批量删除页面
```
POST /api/admin/pages/batch-delete
Body: { "ids": ["id1", "id2", ...] }
```
批量删除多个页面

## 技术实现

### 前端
- **模板引擎**: EJS
- **样式**: 自定义CSS，响应式设计
- **JavaScript**: 原生ES6+，面向对象设计
- **图标**: Font Awesome

### 后端
- **路由**: Express.js
- **数据库**: SQLite
- **认证**: 基于session的认证机制

### 数据库操作
- 新增了多个数据库查询函数：
  - `getAllPages()`: 分页获取页面列表
  - `deletePageById()`: 删除单个页面
  - `batchDeletePages()`: 批量删除页面
  - `getStats()`: 获取统计信息
  - `extractTitle()`: 从HTML内容中提取页面标题

### 标题提取功能
- **自动提取**: 创建页面时自动从HTML内容中提取标题
- **提取优先级**:
  1. 首先尝试提取`<title>`标签内容
  2. 如果没有title标签，提取第一个`<h1>`标签内容
  3. 如果都没有，使用内容前50个字符作为标题
  4. 最后默认为"无标题"
- **标题处理**: 自动去除HTML标签和实体，限制长度为100字符
- **兼容性**: 支持现有数据的标题更新（通过迁移脚本）

## 安全特性
- 所有管理API都需要认证
- 删除操作有确认对话框
- 输入内容进行HTML转义防止XSS
- 使用参数化查询防止SQL注入

## 用户体验
- 现代化的界面设计
- 响应式布局，支持移动设备
- 加载状态指示器
- 操作成功/失败消息提示
- 平滑的动画效果

## 使用说明

1. **登录系统**: 使用管理员密码登录
2. **查看统计**: 页面顶部显示系统统计信息
3. **浏览页面**: 在页面列表中查看所有内容
4. **搜索页面**: 使用搜索框查找特定页面
5. **删除页面**: 
   - 单个删除：点击页面行的"删除"按钮
   - 批量删除：选中多个页面后点击"批量删除"
6. **查看页面**: 点击"查看"按钮在新窗口打开页面

## 注意事项
- 删除操作不可撤销，请谨慎操作
- 建议定期备份数据库文件
- 大量数据时建议使用搜索功能快速定位
- 移动设备上表格会水平滚动以保证可用性 